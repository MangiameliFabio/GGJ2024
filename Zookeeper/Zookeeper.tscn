[gd_scene load_steps=19 format=3 uid="uid://c34jh3v61xojh"]

[ext_resource type="Script" path="res://Zookeeper/zookeeper.gd" id="1_nf5op"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/Zookeeper_State_Machine.gd" id="2_sgkx4"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Idle.gd" id="3_5yo00"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Follow_Player.gd" id="4_13t8d"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Attack.gd" id="5_qsxm6"]
[ext_resource type="PackedScene" uid="uid://doos1hqfu3wdh" path="res://Zookeeper/Zookeeper_Model.tscn" id="6_0t135"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Death.gd" id="6_f5tih"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Charge_Dash.gd" id="7_1du7w"]
[ext_resource type="Script" path="res://StateMachines/Zookeeper/States/Zookeeper_Dash.gd" id="8_mgsos"]
[ext_resource type="PackedScene" uid="uid://b1xe15ymx2g4h" path="res://Models/Entities/Accessories/Cap.glb" id="10_l25wj"]
[ext_resource type="PackedScene" uid="uid://cu3yh1k32fsye" path="res://Prefabs/random_material_color.tscn" id="12_pkhcq"]
[ext_resource type="Shader" uid="uid://bc4my8be82d57" path="res://Models/Entities/Zookeeper/ShirtShader.tres" id="13_fhw7r"]
[ext_resource type="PackedScene" uid="uid://cquj4jyxco6ym" path="res://Prefabs/random_personality.tscn" id="13_x40iv"]
[ext_resource type="Resource" uid="uid://dkxeyf5qc2l7g" path="res://Personalities/ZooKeeperPersonality.tres" id="14_bus4n"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_xat7b"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_a2lte"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("13_fhw7r")
shader_parameter/Color = Color(0.780392, 0.388235, 0.858824, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_jg73q"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("13_fhw7r")
shader_parameter/Color = Color(0.780392, 0.388235, 0.858824, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_4upli"]
radius = 4.0

[node name="Zookeeper" type="CharacterBody3D" groups=["enemy"]]
axis_lock_angular_x = true
axis_lock_angular_z = true
script = ExtResource("1_nf5op")

[node name="World_Collision" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_xat7b")

[node name="ZookeeperStateMachine" type="Node" parent="."]
script = ExtResource("2_sgkx4")
initial_state = NodePath("Follow_Player")

[node name="Idle" type="Node" parent="ZookeeperStateMachine"]
script = ExtResource("3_5yo00")

[node name="Follow_Player" type="Node" parent="ZookeeperStateMachine" node_paths=PackedStringArray("zookeeper")]
script = ExtResource("4_13t8d")
zookeeper = NodePath("../..")

[node name="Attack" type="Node" parent="ZookeeperStateMachine"]
script = ExtResource("5_qsxm6")

[node name="Death" type="Node" parent="ZookeeperStateMachine" node_paths=PackedStringArray("bone")]
script = ExtResource("6_f5tih")
bone = NodePath("../../Zookeeper_Model/Armature_001/Skeleton3D/Physical Bone mixamorig_Spine2")

[node name="Charge_Dash" type="Node" parent="ZookeeperStateMachine"]
script = ExtResource("7_1du7w")

[node name="Dash" type="Node" parent="ZookeeperStateMachine"]
script = ExtResource("8_mgsos")

[node name="Navigation_Agent" type="NavigationAgent3D" parent="."]
target_desired_distance = 1.5
avoidance_enabled = true

[node name="Zookeeper_Model" parent="." instance=ExtResource("6_0t135")]

[node name="Skeleton3D" parent="Zookeeper_Model/Armature_001" index="0"]
bones/6/scale = Vector3(1, 1, 1)
bones/7/scale = Vector3(1, 1, 1)
bones/10/scale = Vector3(1, 1, 1)
bones/13/rotation = Quaternion(0.00577487, -0.11751, -0.048744, 0.991858)
bones/14/scale = Vector3(1, 1, 1)
bones/17/rotation = Quaternion(-2.83947e-06, 0.00100277, 8.71191e-05, 0.999999)
bones/17/scale = Vector3(1, 1, 1)
bones/21/rotation = Quaternion(-2.74392e-06, 0.00092906, 0.000166596, 1)
bones/23/scale = Vector3(1, 1, 1)
bones/25/rotation = Quaternion(1.16762e-07, 0.000145964, -0.000799426, 1)
bones/25/scale = Vector3(1, 1, 1)
bones/29/rotation = Quaternion(-3.54157e-06, 0.00156974, -4.10232e-05, 0.999999)
bones/29/scale = Vector3(1, 1, 1)
bones/30/scale = Vector3(1, 1, 1)
bones/35/scale = Vector3(1, 1, 1)
bones/37/rotation = Quaternion(0.00515177, 0.122683, 0.0416517, 0.991558)
bones/41/rotation = Quaternion(-2.75439e-06, -0.00037744, -1.3016e-05, 1)
bones/45/rotation = Quaternion(2.86989e-08, -0.001024, 2.80173e-05, 0.999999)
bones/49/rotation = Quaternion(-8.0881e-09, 0.000493664, 1.64096e-05, 1)
bones/53/rotation = Quaternion(-3.82118e-06, -0.00078401, -0.000295904, 1)
bones/53/scale = Vector3(1, 1, 1)
bones/54/scale = Vector3(1, 1, 1)
bones/58/rotation = Quaternion(4.36299e-08, 0.0116081, 5.06525e-10, 0.999933)
bones/59/scale = Vector3(1, 1, 1)
bones/61/scale = Vector3(1, 1, 1)
bones/63/rotation = Quaternion(1.21626e-08, -0.0118692, -1.44365e-10, 0.99993)

[node name="Zookeeper" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="0"]
"blend_shapes/Key 1" = 1.0

[node name="Physical Bone mixamorig_Hips" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="1"]
transform = Transform3D(1, -7.79564e-07, 6.22059e-07, 2.78068e-06, 0.999913, -0.0129155, -3.49215e-06, 0.0129184, 0.999927, 0.00178698, 1.61808, -109.355)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.00178374, 0.0018622, 5.08523)
body_offset = Transform3D(1, -7.86036e-07, 1.21072e-07, 3.0268e-06, -1.2638e-06, -1.00001, 2.74181e-06, 0.999996, 1.84868e-06, 0.00178313, 5.08528, -0.00187159)

[node name="Physical Bone mixamorig_Spine2" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="2"]
transform = Transform3D(0.999997, 2.38355e-08, -1.0192e-07, -2.45196e-07, 0.992603, 0.121485, -2.12592e-07, -0.121491, 0.992567, -8.7712e-05, -2.26813, -141.932)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.98429e-05, 0.0880459, 8.43879)
body_offset = Transform3D(0.999997, 5.96046e-08, -2.9804e-08, 3.12924e-07, -3.03984e-06, -0.999974, -2.5332e-07, 1.00001, -4.48525e-06, -8.95964e-05, 8.43857, -0.0880089)

[node name="Physical Bone mixamorig_Shoulder_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="3"]
transform = Transform3D(-0.205694, 0.0494838, 0.977354, 0.978557, -6.69777e-05, 0.205949, 0.0101924, 0.998769, -0.0484228, -9.8664, -4.4325, -144.314)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.53974e-05, -0.00452943, 5.41937)
body_offset = Transform3D(0.999994, -6.44453e-05, 2.5183e-06, -9.23872e-07, 1.33248e-05, -0.99999, 1.58422e-07, 0.999994, -4.53799e-07, 2.14577e-05, 5.41932, 0.00453186)

[node name="Physical Bone mixamorig_Arm_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="4"]
transform = Transform3D(-6.17055e-07, -1.00001, 1.82597e-06, 0.999997, 1.51613e-06, -1.64078e-06, -1.14746e-06, 1.68756e-06, 0.995012, -29.1627, -5.54847, -143.431)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.95335e-05, -13.9998, -0.628057)
body_offset = Transform3D(0.999997, 1.56256e-06, -5.95061e-07, 6.70552e-07, 1.00001, -1.19583e-06, -2.24983e-06, 1.06543e-06, 0.995012, 6.10352e-05, 13.9999, 0.624939)

[node name="Physical Bone mixamorig_ForeArm_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="5"]
transform = Transform3D(-7.71949e-07, -0.99699, 2.03329e-05, 0.996987, -1.74668e-06, -1.63068e-05, 8.26426e-06, 6.60027e-07, 0.996991, -43.0042, -5.54856, -144.052)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.4802e-05, 8.79134e-05, -0.00453023)
body_offset = Transform3D(0.996987, -1.61849e-06, -1.50913e-05, 7.43381e-07, 0.99699, -1.97052e-05, 6.9975e-06, 4.34926e-08, 0.996991, -2.47955e-05, -8.7738e-05, 0.0045166)

[node name="Physical Bone mixamorig_Hand_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="6"]
transform = Transform3D(-1.78848e-06, -0.783671, 0.621171, -0.506162, -0.535718, -0.67185, 0.862436, -0.314416, -0.39667, -72.5657, -4.20765, -143.264)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000198185, 0.00570992, 1.99138)
body_offset = Transform3D(-0.506161, -0.535718, -0.671851, 2.34692e-06, 0.783671, -0.621171, 0.862436, -0.314416, -0.396669, 1.34087, 1.23251, 0.791885)

[node name="Physical Bone mixamorig_Shoulder_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="7"]
transform = Transform3D(-0.205709, -0.0494642, -0.977337, -0.978559, 0.000396518, 0.205959, -0.0102268, 0.998765, -0.0483822, 9.86674, -4.43189, -144.315)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00064267, -0.00406833, 5.41917)
body_offset = Transform3D(0.999999, -0.000388008, -6.95884e-06, -5.51343e-06, -8.09843e-05, -0.999974, -3.88696e-05, 0.999989, 2.14569e-05, -0.000606537, 5.41903, 0.00395203)

[node name="Physical Bone mixamorig_Arm_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="8"]
transform = Transform3D(4.14188e-05, -6.57144e-06, -0.999995, -0.997396, 1.15752e-05, 4.99126e-07, -1.21492e-05, 0.999996, -2.37128e-06, 29.0534, -5.56365, -143.598)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0151876, -0.458413, 13.8907)
body_offset = Transform3D(0.997396, -1.131e-05, -3.02494e-06, 3.87877e-05, -5.90086e-06, -0.999995, -1.23754e-05, 0.999996, -1.71936e-06, 0.0151849, 13.8906, 0.458435)

[node name="Physical Bone mixamorig_ForeArm_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="9"]
transform = Transform3D(4.63548e-06, -4.47886e-06, -0.999981, -0.999993, 1.01925e-06, -1.08922e-06, -2.01737e-06, 0.995006, -4.39583e-06, 57.1684, -5.54863, -144.052)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000208528, -0.00463915, 14.1644)
body_offset = Transform3D(0.999993, -7.56873e-07, -1.43735e-06, 1.99676e-06, -2.75242e-06, -0.999982, -2.24262e-06, 0.995006, -2.67939e-06, 0.000228882, 14.1641, 0.00465393)

[node name="Physical Bone mixamorig_Hand_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="10"]
transform = Transform3D(6.1326e-07, 0.783601, -0.621198, 0.506693, -0.535585, -0.673529, -0.859739, -0.312311, -0.395023, 72.5662, -4.20752, -143.264)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00545657, 0.00478545, 1.99109)
body_offset = Transform3D(-0.506693, 0.535587, 0.673527, 2.46592e-07, 0.783599, -0.621201, -0.859739, -0.312313, -0.395022, -1.34085, 1.23312, 0.792709)

[node name="Physical Bone mixamorig_UpLeg_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="11"]
transform = Transform3D(-0.999973, -5.69976e-05, -5.79159e-06, -2.61802e-05, 0.998569, -0.0104218, -2.00571e-05, -0.0103206, -0.996127, -8.20753, 0.183237, -75.3296)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.000121749, 0.00360852, 22.275)
body_offset = Transform3D(0.999973, 5.68724e-05, 4.41517e-06, -2.16774e-05, -0.00119351, -0.996181, -2.5872e-05, 0.998622, -0.00131703, -0.000220299, 22.1899, 0.0257332)

[node name="Physical Bone mixamorig_Leg_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="12"]
transform = Transform3D(-0.99994, -2.14766e-05, 0.000891863, 0.000289986, 0.99709, 0.0716587, -0.000214826, 0.070834, -0.991573, -8.11978, -1.16118, -30.9368)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.107914, -0.0836276, 22.3947)
body_offset = Transform3D(0.99994, 2.15322e-05, -0.000893273, -0.00023593, 0.00117683, -0.994156, 0.000274256, 0.999603, 0.00238407, -0.0879011, 22.2639, 0.0301745)

[node name="Physical Bone mixamorig_Foot_R" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="13"]
transform = Transform3D(-0.999988, -3.71899e-06, 1.22174e-06, 3.61967e-06, 0.631736, -0.775152, 6.26736e-06, -0.775166, -0.631728, -8.12016, 2.5961, -4.36513)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0875033, 0.0100525, 6.89574)
body_offset = Transform3D(0.999988, 2.68221e-06, -1.77324e-06, 6.21375e-06, 3.69549e-06, -0.999971, -1.53485e-06, 0.999987, 6.28829e-06, -0.0874901, 6.89554, -0.0100956)

[node name="Physical Bone mixamorig_UpLeg_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="14"]
transform = Transform3D(-0.999994, -1.91705e-07, -2.29737e-06, -9.63866e-08, 0.999454, -0.01042, -3.53891e-07, -0.0104224, -1.00005, 8.20773, 0.185079, -75.3292)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000122375, 0.000820607, 22.1881)
body_offset = Transform3D(0.999994, -4.47035e-08, 9.16295e-07, -1.73599e-06, -0.00130785, -1.0001, 1.41561e-07, 0.999507, -0.00129997, 0.000102043, 22.1903, 0.0280237)

[node name="Physical Bone mixamorig_Leg_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="15"]
transform = Transform3D(-0.995007, -1.69835e-05, -3.90833e-06, 6.35732e-07, 0.98786, 0.0701555, 2.12758e-06, 0.0703078, -0.989115, 8.2073, -1.16289, -30.9367)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000649796, -0.0536086, 22.4527)
body_offset = Transform3D(0.995007, 1.71539e-05, 2.50274e-06, 6.67521e-07, 0.00131758, -0.991599, 6.13087e-07, 0.990358, 0.00107831, 0.000591278, 22.2641, 0.0288808)

[node name="Physical Bone mixamorig_Foot_L" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="16"]
transform = Transform3D(-0.999719, 0.00137196, -0.000758555, -7.21407e-06, 0.624254, -0.766218, -0.000914558, -0.765907, -0.625551, 8.20824, 2.61308, -4.36374)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.00499532, -0.00567054, 6.98529)
body_offset = Transform3D(0.999719, -0.00137284, 0.000757903, -0.000584014, 5.38528e-05, -0.989143, 0.000705279, 0.988082, 0.000862002, -0.000308037, 6.90944, -0.000414848)

[node name="BoneAttachment3D" type="BoneAttachment3D" parent="Zookeeper_Model/Armature_001/Skeleton3D" index="17"]
transform = Transform3D(1, 7.21177e-08, -3.57685e-08, 4.42653e-08, -0.121493, 0.992592, 6.72378e-08, -0.992592, -0.121493, 2.95385e-06, -1.51955, -159.925)
bone_name = "mixamorig_Head"
bone_idx = 5

[node name="Offset" type="Node3D" parent="Zookeeper_Model/Armature_001/Skeleton3D/BoneAttachment3D"]
transform = Transform3D(100, 0, 0, 0, 100, 0, 0, 0, 100, 0, 0, 0)

[node name="Cap2" parent="Zookeeper_Model/Armature_001/Skeleton3D/BoneAttachment3D/Offset" instance=ExtResource("10_l25wj")]
transform = Transform3D(1, 1.86265e-09, -1.40863e-08, -9.31323e-09, 1, -3.72529e-08, 1.28057e-09, 7.45058e-09, 1, 0.005781, 0.144121, 0.0707836)

[node name="RandomMaterialColor" parent="Zookeeper_Model/Armature_001/Skeleton3D/BoneAttachment3D/Offset/Cap2" node_paths=PackedStringArray("MeshNode") instance=ExtResource("12_pkhcq")]
MeshNode = NodePath("../Cap")
ShirtMaterial = SubResource("ShaderMaterial_a2lte")
MaterialIndex = 0

[node name="AnimationPlayer" parent="Zookeeper_Model" index="1"]
playback_default_blend_time = 0.25

[node name="RandomMaterialColor" parent="Zookeeper_Model" node_paths=PackedStringArray("MeshNode") instance=ExtResource("12_pkhcq")]
MeshNode = NodePath("../Armature_001/Skeleton3D/Zookeeper")
ShirtMaterial = SubResource("ShaderMaterial_jg73q")

[node name="Dash_Trigger" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Dash_Trigger"]
shape = SubResource("SphereShape3D_4upli")

[node name="RandomPersonality" parent="." node_paths=PackedStringArray("MeshNode", "audioPlayer") instance=ExtResource("13_x40iv")]
MeshNode = NodePath("../Zookeeper_Model/Armature_001/Skeleton3D/Zookeeper")
Personalities = Array[Resource("res://Personality.gd")]([ExtResource("14_bus4n")])
audioPlayer = NodePath("AudioStreamPlayer3D")

[connection signal="OnAttack" from="." to="RandomPersonality" method="play_attack_sound"]
[connection signal="OnGetHit" from="." to="RandomPersonality" method="play_hit_sound"]
[connection signal="target_reached" from="Navigation_Agent" to="." method="_on_navigation_agent_target_reached"]
[connection signal="animation_finished" from="Zookeeper_Model/AnimationPlayer" to="ZookeeperStateMachine/Charge_Dash" method="_on_animation_player_animation_finished"]
[connection signal="animation_finished" from="Zookeeper_Model/AnimationPlayer" to="ZookeeperStateMachine/Dash" method="_on_animation_player_animation_finished"]
[connection signal="body_entered" from="Dash_Trigger" to="." method="_on_dash_trigger_entered"]

[editable path="Zookeeper_Model"]
[editable path="Zookeeper_Model/Armature_001/Skeleton3D/BoneAttachment3D/Offset/Cap2"]
[editable path="RandomPersonality"]
